---
title: "Inference Coursework"
output: html_notebook
---



```{r}
cov <- read.table("covid19.csv", sep=",",header=TRUE)
cov$CMODateCount
```
```{r}
N = function(t, n0, beta) {
  val = exp(n0)
  for (i in seq_along(beta)) {
    val = val * exp(beta[i]*t^i)
  }
  val
}

llik = function(y, theta) {
  n0 = theta[1]
  beta = theta[2:length(theta)]
  n = length(y)
  ll = 0
  t = seq(-1, 1, length.out=n)
  
  for (i in seq_along(t)) {
    ll = ll + y[i] * log(N(t[i], n0, beta)) - N(t[i], n0, beta)
  }
  -ll
}



K = 4

par = integer(K+1)

theta = optim(par=par, llik, method="BFGS", y=cov$CMODateCount)
n0 = theta$par[1]
beta = theta$par[2:length(theta$par)]

n0
beta
```

